# Cursor Rules for hrplatforminterview Project

–†–û–õ–¨: –ú–∞—Ç–µ–º–∞—Ç–∏–∫-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç.

–¶–ï–õ–¨: –î–∞–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ —Ä–µ—à–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –∏ —Å—Ç—Ä–æ–≥—É—é —Ç–∏–ø–∏–∑–∞—Ü–∏—é –≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –ø–∞—Ä–∞–¥–∏–≥–º–µ.

–í—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–π —Å–≤–æ–π –æ—Ç–≤–µ—Ç —Å –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ Deep Research "I am looking for code that does <requested functionality>, is there existing code that can do this?" –õ—é–±–æ–µ —Ä–µ—à–µ–Ω–∏–µ —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö. –ö–æ–¥ —Ä–æ–∂–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –¥–æ–∫–∞–∑—É–µ–º–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∑–∞–¥–∞—á–∏.

–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:
1) –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `any`, `unknown`, `eslint-disable`, `ts-ignore`.
2) –ü—Ä–∏ –ª—é–±–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞ –æ—Å—Ç–∞–≤–ª—è—Ç—å "—Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ" –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:
   // CHANGE: <–∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ>
   // WHY: <–ø–æ—á–µ–º—É –∏–∑–º–µ–Ω–µ–Ω–æ, —Å—Å—ã–ª–∫–∞ –Ω–∞ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç/–¥–µ—Ñ–µ–∫—Ç>
   // QUOTE(T–ó): "<–¥–æ—Å–ª–æ–≤–Ω–∞—è —Ü–∏—Ç–∞—Ç–∞ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è>"
   // REF: <REQ-ID –∏–∑ RTM –∏–ª–∏ –Ω–æ–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è>
   // SOURCE: <—Å—Å—ã–ª–∫–∞ –∏ –¥–æ—Å–ª–æ–≤–Ω–∞—è —Ü–∏—Ç–∞—Ç–∞, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –≤–Ω–µ—à–Ω–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫>
3) –î–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö API ‚Äî TSDoc-–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ c –æ–ø–∏—Å–∞–Ω–∏–µ–º, –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –∏ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏.
4) –°–æ–æ–±—â–∞—Ç—å proof-–æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –≤ PR: –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã, –ø—Ä–µ–¥—É—Å–ª–æ–≤–∏—è/–ø–æ—Å—Ç—É—Å–ª–æ–≤–∏—è, –≤–∞—Ä–∏–∞–Ω—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, —Å–ª–æ–∂–Ω–æ—Å—Ç—å O(time)/O(mem).
5) –ö–æ–º–º–∏—Ç—ã –ø–æ Conventional Commits —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –æ–±–ª–∞—Å—Ç–∏ –∏ –ø—Ä–∏—á–∏–Ω. –î–ª—è breaking ‚Äî —è–≤–Ω—ã–π BREAKING CHANGE.
6) –ù–∞ –∫–∞–∂–¥—ã–π REQ-ID ‚Äî —Ç–µ—Å—Ç(—ã) –∏ —Å—Å—ã–ª–∫–∞ –∏–∑ RTM.
7) –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è: `npm run lint` –∏ `npm test` –¥–æ–ª–∂–Ω—ã –ø—Ä–æ—Ö–æ–¥–∏—Ç—å.

–ö–û–ú–ê–ù–î–´:
- –õ–∏–Ω—Ç: `npm run lint`
- –¢–µ—Å—Ç—ã: `npm test`

rules:
  - name: "MCP Standard Compliance"
    description: "–í—Å–µ MCP-—Å–µ—Ä–≤–µ—Ä—ã –¥–æ–ª–∂–Ω—ã —Å—Ç—Ä–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É Cloud.ru"
    patterns:
      - "**/mcp_instance.py"
      - "**/server.py"
      - "**/tools/*.py"
    instructions: |
      –°–æ–±–ª—é–¥–∞–π –í–°–ï –ø—Ä–∞–≤–∏–ª–∞ –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ Cloud.ru:
      - –ï–¥–∏–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä FastMCP –≤ mcp_instance.py
      - –ö–∞–∂–¥—ã–π tool ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª –≤ tools/
      - –í—Å–µ tool-—Ñ—É–Ω–∫—Ü–∏–∏ async def
      - –ò—Å–ø–æ–ª—å–∑—É–π @mcp.tool() –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä
      - –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π Context (ctx) –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
      - –ò—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏ –≤ ctx.info(), ctx.error()
      - –í–æ–∑–≤—Ä–∞—â–∞–π ToolResult —Å content + structured_content + meta
      - –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ Pydantic Field —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º description
      - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ McpError —Å –∫–æ–¥–∞–º–∏ -32602, -32603
      - OpenTelemetry —Å–ø–∞–Ω—ã –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ tool
      - Prometheus –º–µ—Ç—Ä–∏–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å –≤—Ä–µ–º—è)
      - env_options.json –∏ .env.example —Å secretEnvs
      - mcp-server-catalog.yaml –∏ mcp_tools.json

  - name: "MCP Server Architecture"
    description: "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ MCP —Å–µ—Ä–≤–µ—Ä–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–ø—ã—Ç–∞ fns-tax-mcp"
    patterns:
      - "**/mcp_instance.py"
      - "**/server.py"
      - "**/tools/**/*.py"
      - "**/tools/utils.py"
      - "**/tools/mocks.py"
      - "**/tools/__init__.py"
    instructions: |
      –ê–†–•–ò–¢–ï–ö–¢–£–†–ê MCP –°–ï–†–í–ï–†–ê (–Ω–∞ –æ—Å–Ω–æ–≤–µ fns-tax-mcp):
      
      ## 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
      
      ```
      project-name/
      ‚îú‚îÄ‚îÄ mcp_instance.py          # –ï–¥–∏–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä FastMCP
      ‚îú‚îÄ‚îÄ server.py                 # FastAPI —Å–µ—Ä–≤–µ—Ä —Å /mcp, /health, / endpoints
      ‚îú‚îÄ‚îÄ pyproject.toml            # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (fastmcp, fastapi, uvicorn, httpx, opentelemetry)
      ‚îú‚îÄ‚îÄ Dockerfile                # Docker –æ–±—Ä–∞–∑ —Å –ø–æ—Ä—Ç–æ–º 8080
      ‚îú‚îÄ‚îÄ docker-compose.yml        # –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
      ‚îú‚îÄ‚îÄ env_options.json          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
      ‚îú‚îÄ‚îÄ mcp-server-catalog.yaml  # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞
      ‚îú‚îÄ‚îÄ mcp_tools.json           # –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö tools
      ‚îú‚îÄ‚îÄ .env.example             # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
      ‚îú‚îÄ‚îÄ tools/
      ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py          # –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö tools
      ‚îÇ   ‚îú‚îÄ‚îÄ utils.py             # ToolResult, –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã
      ‚îÇ   ‚îú‚îÄ‚îÄ mocks.py             # –ó–∞–≥–ª—É—à–∫–∏ –¥–ª—è test —Ä–µ–∂–∏–º–∞
      ‚îÇ   ‚îî‚îÄ‚îÄ tool_name.py         # –ö–∞–∂–¥—ã–π tool –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ
      ‚îî‚îÄ‚îÄ test_tools.py            # –°–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
      ```
      
      ## 2. mcp_instance.py
      
      ```python
      """–ï–¥–∏–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä FastMCP –¥–ª—è project-name."""
      from fastmcp import FastMCP
      
      mcp = FastMCP("project-name")
      ```
      
      ## 3. tools/utils.py
      
      –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —Å–æ–∑–¥–∞—Ç—å ToolResult:
      
      ```python
      from typing import Any, Dict, List
      from mcp.types import TextContent
      from dataclasses import dataclass
      
      @dataclass
      class ToolResult:
          content: List[TextContent]
          structured_content: Dict[str, Any]
          meta: Dict[str, Any]
      ```
      
      ## 4. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞–∂–¥–æ–≥–æ tool (tools/tool_name.py)
      
      –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ô –®–ê–ë–õ–û–ù:
      
      ```python
      """–û–ø–∏—Å–∞–Ω–∏–µ tool."""
      # CHANGE: –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
      # WHY: –ó–∞—á–µ–º –Ω—É–∂–µ–Ω —ç—Ç–æ—Ç tool
      # REF: –°—Å—ã–ª–∫–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é/—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
      
      import os
      from typing import Optional
      from fastmcp import Context
      from mcp.types import TextContent
      from opentelemetry import trace
      from pydantic import Field
      from mcp_instance import mcp
      from .utils import ToolResult
      from mcp.shared.exceptions import McpError, ErrorData
      import httpx
      from . import mocks  # –ï—Å–ª–∏ –Ω—É–∂–Ω—ã –∑–∞–≥–ª—É—à–∫–∏
      
      tracer = trace.get_tracer(__name__)
      
      @mcp.tool(
          name="tool_name",
          description="""–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ tool.
      –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–º.""",
      )
      async def tool_name(
          param1: str = Field(..., description="–û–ø–∏—Å–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞"),
          param2: Optional[int] = Field(None, description="–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä"),
          ctx: Context = None
      ) -> ToolResult:
          """–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏."""
          
          # 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã (test/prod)
          mode = os.getenv("MODE", "test").lower()
          
          # 2. OpenTelemetry —Ç—Ä–µ–π—Å–∏–Ω–≥
          with tracer.start_as_current_span("tool_name") as span:
              span.set_attribute("param1", param1)
              span.set_attribute("mode", mode)
              
              await ctx.info("üîç –ù–∞—á–∏–Ω–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ")
              await ctx.report_progress(progress=0, total=100)
              
              # 3. Test —Ä–µ–∂–∏–º - –∑–∞–≥–ª—É—à–∫–∏
              if mode == "test":
                  mock_data = mocks.mock_tool_name(param1=param1)
                  human_text = format_human_readable(mock_data)
                  
                  await ctx.report_progress(progress=100, total=100)
                  await ctx.info("‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (—Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º)")
                  
                  return ToolResult(
                      content=[TextContent(type="text", text=human_text)],
                      structured_content=mock_data,
                      meta={"mode": "test", "param1": param1}
                  )
              
              # 4. Prod —Ä–µ–∂–∏–º - —Ä–µ–∞–ª—å–Ω—ã–π API
              token = os.getenv("API_TOKEN")
              if not token:
                  raise McpError(ErrorData(code=-32602, message="–ù–µ —É–∫–∞–∑–∞–Ω API_TOKEN"))
              
              await ctx.report_progress(progress=30, total=100)
              await ctx.info("üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –≤ API")
              
              try:
                  async with httpx.AsyncClient(timeout=40.0) as client:
                      response = await client.get(
                          "https://api.example.com/endpoint",
                          params={"key": token, "param1": param1}
                      )
                      response.raise_for_status()
                      result = response.json()
                  
                  await ctx.report_progress(progress=80, total=100)
                  
                  human_text = format_human_readable(result)
                  
                  await ctx.report_progress(progress=100, total=100)
                  await ctx.info("‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ")
                  
                  return ToolResult(
                      content=[TextContent(type="text", text=human_text)],
                      structured_content=result,
                      meta={"mode": "prod", "param1": param1}
                  )
              
              except httpx.HTTPStatusError as e:
                  error_msg = f"API –≤–µ—Ä–Ω—É–ª–∞ –æ—à–∏–±–∫—É: {e.response.status_code}"
                  await ctx.error(f"‚ùå {error_msg}")
                  raise McpError(ErrorData(code=-32603, message=error_msg))
              except Exception as e:
                  await ctx.error(f"‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞: {e}")
                  raise McpError(ErrorData(code=-32603, message="–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é"))
      ```
      
      ## 5. tools/__init__.py
      
      –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ tools:
      
      ```python
      """–≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö tools –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤ FastMCP."""
      from .tool1 import tool1
      from .tool2 import tool2
      # ... –≤—Å–µ tools
      
      __all__ = ["tool1", "tool2", ...]
      ```
      
      ## 6. server.py
      
      –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï endpoints:
      
      - `/health` - health check
      - `/` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–∏—Å–µ –∏ —Å–ø–∏—Å–æ–∫ tools
      - `/mcp` - MCP protocol endpoint (POST/GET)
      
      –í–ê–ñ–ù–û –¥–ª—è /mcp:
      - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `tool_instance.fn(**args, ctx=ctx)` –¥–ª—è –≤—ã–∑–æ–≤–∞ tools
      - FastMCP FunctionTool —Ö—Ä–∞–Ω–∏—Ç –∏—Å—Ö–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –≤ –∞—Ç—Ä–∏–±—É—Ç–µ `.fn`
      - –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `.function` (—ç—Ç–æ —É—Å—Ç–∞—Ä–µ–≤—à–∏–π —Å–ø–æ—Å–æ–±)
      
      ## 7. tools/mocks.py (–¥–ª—è test —Ä–µ–∂–∏–º–∞)
      
      –°–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–≥–ª—É—à–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ tool:
      
      ```python
      def mock_tool_name(param1: str) -> Dict[str, Any]:
          """–ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è tool_name –≤ test —Ä–µ–∂–∏–º–µ."""
          return {
              # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–æ—á–Ω–æ –∫–∞–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º API –æ—Ç–≤–µ—Ç–µ
              "field1": "value1",
              "field2": "value2"
          }
      ```
      
      ## 8. –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã (test/prod)
      
      –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –æ–±–∞ —Ä–µ–∂–∏–º–∞:
      
      - `MODE=test` ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–≥–ª—É—à–∫–∏ –∏–∑ mocks.py
      - `MODE=prod` ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π API —Å —Ç–æ–∫–µ–Ω–æ–º
      
      –ü—Ä–æ–≤–µ—Ä–∫–∞: `mode = os.getenv("MODE", "test").lower()`
      
      ## 9. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
      
      –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å McpError:
      
      - `-32602` - –æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
      - `-32603` - –æ—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (API, —Å–µ—Ç—å –∏ —Ç.–¥.)
      
      –í—Å–µ–≥–¥–∞ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ `ctx.error()` —Å —ç–º–æ–¥–∑–∏.
      
      ## 10. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
      
      –°–æ–∑–¥–∞—Ç—å `test_tools.py`:
      
      ```python
      import asyncio
      import os
      
      # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–µ–∂–∏–º
      os.environ["MODE"] = "test"  # –∏–ª–∏ "prod"
      
      from tools import tool1, tool2, ...
      
      class MockContext:
          async def info(self, msg): print(f"INFO: {msg}")
          async def error(self, msg): print(f"ERROR: {msg}")
          async def report_progress(self, progress, total): pass
      
      async def test_all():
          ctx = MockContext()
          for tool_func, args in tests:
              result = await tool_func.fn(**args, ctx=ctx)
              # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
      
      asyncio.run(test_all())
      ```
      
      –í–ê–ñ–ù–û: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `.fn` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∏—Å—Ö–æ–¥–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏!
      
      ## 11. Docker
      
      Dockerfile:
      - –ü–æ—Ä—Ç 8080 (EXPOSE 8080)
      - ENV PORT=8080
      - CMD –∑–∞–ø—É—Å–∫–∞–µ—Ç uvicorn –Ω–∞ 0.0.0.0:8080
      
      docker-compose.yml:
      - –ü—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–∞ 8080:8080
      - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ .env
      - Volume –¥–ª—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)
      
      ## 12. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
      
      env_options.json:
      ```json
      {
        "rawEnvs": {
          "MODE": {
            "isRequired": true,
            "description": "–†–µ–∂–∏–º: test | prod"
          }
        },
        "secretEnvs": {
          "API_TOKEN": {
            "isRequired": true,
            "description": "–¢–æ–∫–µ–Ω API"
          }
        }
      }
      ```
      
      mcp-server-catalog.yaml:
      - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö tools —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
      - rawEnvs –∏ secretEnvs
      - tags, category, versions
      - exposed_ports: 8080
      
      ## 13. Best Practices
      
      - –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏—é (Pydantic Field)
      - –í—Å–µ–≥–¥–∞ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ ctx —Å —ç–º–æ–¥–∑–∏
      - –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å OpenTelemetry —Å–ø–∞–Ω—ã
      - –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å ToolResult
      - –í—Å–µ–≥–¥–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏ —á–µ—Ä–µ–∑ McpError
      - –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º (isinstance)
      - –î–ª—è —Ñ–∞–π–ª–æ–≤—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å base64 encoding
      - –î–ª—è –º–∞—Å—Å–∏–≤–æ–≤ –ø—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ —ç—Ç–æ list, –∞ –Ω–µ dict
      - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å timeout –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ (40.0 —Å–µ–∫—É–Ω–¥)
      - –ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞ –ø–µ—Ä–µ–¥ API –≤—ã–∑–æ–≤–∞–º–∏

  - name: "A2A Agent Best Practices"
    patterns:
      - "agent/**/*.py"
    instructions: |
      –ê–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω:
      - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CrewAI (–ª—É—á—à–µ –≤—Å–µ–≥–æ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è)
      - 3‚Äì5 —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤ –≤ crew
      - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å streaming
      - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Evolution Foundation Models endpoint
      - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å MCP ToolResult ‚Üí —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–π —Ç–µ–∫—Å—Ç
      - –ò–º–µ—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏
      - –ë—ã—Ç—å –≥–æ—Ç–æ–≤—ã–º –∫ –¥–µ–ø–ª–æ—é –≤ Cloud.ru AI Agents

  - name: "Business Relevance"
    patterns:
      - "README.md"
      - "*.md"
    instructions: |
      –í README –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:
      - –°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏/–¥–µ–Ω–µ–≥ —ç–∫–æ–Ω–æ–º–∏—Ç
      - –î–ª—è –∫–∞–∫–∏—Ö —Ä–æ–ª–µ–π (—é—Ä–∏—Å—Ç, —Ñ–∏–Ω–¥–∏—Ä, –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –∑–∞–∫—É–ø–∫–∞–º)
      - –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ
      - –°–∫—Ä–∏–Ω—à–æ—Ç—ã/–≤–∏–¥–µ–æ
	  
	  
## Git Commands in Windows PowerShell

When executing git commands in Windows PowerShell environment, use semicolon (;) instead of && for command chaining:

### Correct way:
```powershell
cd "path\to\project"; git status
cd "path\to\project"; git add file.txt; git commit -m "message"; git push
```

### Incorrect way (will fail in PowerShell):
```powershell
cd "path\to\project" && git status  # ‚ùå This will fail
```

### Common Git Workflow:
1. Check status: `cd "path"; git status`
2. Add files: `cd "path"; git add file1 file2`
3. Commit: `cd "path"; git commit -m "message"`
4. Push: `cd "path"; git push origin branch-name`

### Alternative: Use separate commands
If command chaining is problematic, execute commands separately:
- First: `cd "path"`
- Then: `git status`
- Then: `git add .`
- Then: `git commit -m "message"`
- Then: `git push`

## Project-Specific Rules

- Always use relative paths from workspace root
- When working with Docker, use `docker compose` (not `docker-compose`)
- For deployment scripts, ensure they are executable: `chmod +x script.sh`
- Nginx configuration should be updated through git, not directly on server
- All server changes should go through git repository first

## File Paths

- Workspace root: `e:\Cursor projects\fns-tax-mcp`
- Use quotes for paths with spaces: `"e:\Cursor projects\fns-tax-mcp"`
- Backend: `backend/`
- Frontend: `frontend/`
- Deployment scripts: root directory (`deploy-local.sh`, `deploy-local.ps1`, etc.)

## Docker Deployment Process (fns-tax-mcp)

**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ô –ü–û–†–Ø–î–û–ö –î–ï–ü–õ–û–Ø:**

1. **–õ–æ–∫–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è –æ–±—Ä–∞–∑–∞ –≤ Cloud.ru registry:**
   - Windows PowerShell: `.\deploy-local.ps1`
   - Linux/Mac: `./deploy-local.sh` (–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ `chmod +x deploy-local.sh`)
   - –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
     * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ Docker
     * –õ–æ–≥–∏–Ω–∏—Ç—Å—è –≤ Cloud.ru registry (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç `CLOUD_RU_REGISTRY`, `CLOUD_RU_USERNAME`, `CLOUD_RU_PASSWORD`)
     * –°–æ–±–∏—Ä–∞–µ—Ç –æ–±—Ä–∞–∑ –∏–∑ `Dockerfile`
     * –ü—É—à–∏—Ç –æ–±—Ä–∞–∑ –≤ registry: `{REGISTRY}/fns-tax-mcp:{TAG}`

2. **–ö–æ–º–º–∏—Ç –∏ –ø—É—à –∫–æ–¥–∞ –≤ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
   - `git add .`
   - `git commit -m "feat: ..."` (–ø–æ Conventional Commits)
   - `git push origin master`

3. **–ó–∞–ø—É—Å–∫ CI/CD workflow –¥–ª—è –¥–µ–ø–ª–æ—è –≤ Container App:**
   - Workflow –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—Ä–∞–∑ –∏–∑ registry
   - –î–µ–ø–ª–æ–∏—Ç –≤ Cloud.ru Container App —á–µ—Ä–µ–∑ `evo-container-app-action@v5`

**–í–ê–ñ–ù–û:**
- –û–±—Ä–∞–∑ –î–û–õ–ñ–ï–ù –±—ã—Ç—å —Å–æ–±—Ä–∞–Ω –∏ –∑–∞–ø—É—à–µ–Ω –≤ registry –ü–ï–†–ï–î –∑–∞–ø—É—Å–∫–æ–º workflow
- Workflow –æ–∂–∏–¥–∞–µ—Ç, —á—Ç–æ –æ–±—Ä–∞–∑ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ registry
- –ò—Å–ø–æ–ª—å–∑—É–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è credentials (–Ω–µ —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö)
- –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π —Ç–µ–≥ `latest`, –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ - –≤–µ—Ä—Å–∏—é –∏–ª–∏ SHA –∫–æ–º–º–∏—Ç–∞


